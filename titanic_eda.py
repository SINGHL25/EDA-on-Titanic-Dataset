# -*- coding: utf-8 -*-
"""titanic_eda.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1h2siYFIGpXax6KXlkZV3rHgZesS_o2Eu

# New Section
"""

import pandas as pd

train = pd.read_csv('/content/titanic.csv')
test = pd.read_csv('/content/test.csv')
submission = pd.read_csv('/content/gender_submission.csv')

print(train.head())
train.info()

import seaborn as sns
import matplotlib.pyplot as plt

sns.countplot(data=train, x='Sex', hue='Survived')
plt.title("Survival by Gender")
plt.show()

from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split

X = train[['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare']]
X['Sex'] = X['Sex'].map({'male': 0, 'female': 1})
X['Age'].fillna(X['Age'].median(), inplace=True)
X['Fare'].fillna(X['Fare'].median(), inplace=True)

y = train['Survived']
X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2)

model = RandomForestClassifier()
model.fit(X_train, y_train)
print("Validation Accuracy:", model.score(X_val, y_val))

test_features = test[['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare']]
test_features['Sex'] = test_features['Sex'].map({'male': 0, 'female': 1})
test_features['Age'].fillna(X['Age'].median(), inplace=True)
test_features['Fare'].fillna(X['Fare'].median(), inplace=True)

predictions = model.predict(test_features)

output = pd.DataFrame({'PassengerId': test['PassengerId'], 'Survived': predictions})
output.to_csv('submission.csv', index=False)
print("Submission file saved!")